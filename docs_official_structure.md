# ๐ ุชูุซูู ุฑุณูู โ Gamasa Properties

ูุฐุง ุงูููู ููุซู **ุงูุชุญููู ุงูุฑุณูู** ููุฃููุงุฑ ูุงููุชุทูุจุงุช ุฅูู ูุซุงุฆู ููุธูุฉ ูุงุจูุฉ ููุชูููุฐ ุฏุงุฎู ูุฌูุฏ `docs/`.

---

## 00-overview.md | ูุธุฑุฉ ุนุงูุฉ
### ุงููุฏู
ููุตุฉ ุนูุงุฑูุฉ ูุชุฎุตุตุฉ ูู **ูุฏููุฉ ุฌูุตุฉ** ูุฏุนู ุงูุฅูุฌุงุฑ (ูููู โ ุดูุฑู โ ููุณูู โ ุณููู) ูุน ูุธุงู ุญุฌุฒ ูุฑู ูุชูุงุตู ูุจุงุดุฑ ุจูู ุงููุณุชุฃุฌุฑ ูุงููุคุฌุฑ.

### ุฃููุงุน ุงููุณุชุฎุฏููู
- ูุณุชุฃุฌุฑ (Tenant)
- ูุคุฌุฑ (Landlord)

---

## 01-user-types.md | ุฃููุงุน ุงููุณุชุฎุฏููู

### ุงููุคุฌุฑ (Landlord)
ูุฏ ูููู:
- ูุงูู ุนูุงุฑ (ุดูุฉ / ุนูุงุฑุฉ / ูููุง)
- ุณูุณุงุฑ
- ุทุงูุจ ูุงู ุจุงุณุชุฆุฌุงุฑ ุดูุฉ ููุฑุบุจ ูู ุชุฃุฌูุฑ ุบุฑู ุฃู ุณุฑุงูุฑ

#### ุตูุญุงุช ุงููุคุฌุฑ ุงูุฃุณุงุณูุฉ
- ุตูุญุฉ ุงูุจุฑููุงูู
- ุตูุญุฉ ุฅุถุงูุฉ ุนูุงุฑ
- ุตูุญุฉ ุญุฌูุฒุงุชู (ูุจูู / ุฑูุถ)

#### ุตูุงุญูุงุช ุงููุคุฌุฑ
- ุฅุถุงูุฉ ูุชุนุฏูู ุงูุนูุงุฑุงุช
- ูุจูู ุฃู ุฑูุถ ุทูุจุงุช ุงูุญุฌุฒ
- ุงูุชุญูู ูู ุญุงูุฉ ุงูุนูุงุฑ

---

### ุงููุณุชุฃุฌุฑ (Tenant)
ุฃููุงุน ุงููุณุชุฃุฌุฑูู:
- ุทุงูุจ
- ุนุงูู
- ุณูุงุญุฉ

#### ุตูุญุงุช ุงููุณุชุฃุฌุฑ ุงูุฃุณุงุณูุฉ
- ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ
- ุตูุญุฉ ุชูุงุตูู ุงูุนูุงุฑ
- ุตูุญุฉ ุญุฌูุฒุงุชู

---

## 02-property-types.md | ุฃููุงุน ุงูุนูุงุฑุงุช

### ูููุง
- ูุฑูุจุฉ ูู ุงูุจุญุฑ ุฃู ุชุญุชูู ุนูู ุญุฏููุฉ
- ูุฏุฎู ูุณุชูู (ุญุชู ูู ุฏุงุฎู ุนูุงุฑุฉ)
- ูููู ุชุฃุฌูุฑูุง: ูุงููุฉ / ุบุฑูุฉ / ุณุฑูุฑ

### ุนูุงุฑุฉ ุณูููุฉ
- ุชุญุฏูุฏ ุณูุงุณุฉ ุงูุณูู: (ุฃุณุฑ โ ุจูุงุช โ ุดุจุงุจ)
- ุงููุญุฏุงุช ุฏุงุฎููุง: ุดูุฉ / ุบุฑูุฉ / ุณุฑูุฑ

---

## 03-property-features.md | ููุงุตูุงุช ุงูุนูุงุฑ
- ุนุฏุฏ ุงูุบุฑู
- ุนุฏุฏ ุงูุณุฑุงูุฑ (1โ2)
- ุงูุญุฏ ุงูุฃูุตู ููุฃุดุฎุงุต (ูุญุฏุฏู ุงููุคุฌุฑ)
- ุงูุฏูุฑ (ููุดูู)
- ูููุฒุงุช ุฅุถุงููุฉ:
  - ููุงุชูุฑ ุนูู ุงููุคุฌุฑ
  - ุฅูุชุฑูุช
  - ููุฑูุด / ุบูุฑ ููุฑูุด

---

## 04-location-system.md | ูุธุงู ุงููููุน
- ุงุฎุชูุงุฑ ููุทูุฉ ุฌุงูุฒุฉ (ูุฏูุฑ โ ุงููุฑูู โ โฆ)
- ุชุญุฏูุฏ ุฏุจูุณ ุงููููุน ุนูู ุงูุฎุฑูุทุฉ (Map Pin)
- ุงูุชูุงูู ูุน Leaflet

---

## 05-pricing-system.md | ูุธุงู ุงูุชุณุนูุฑ

### ุฃููุงุน ุงูุฅูุฌุงุฑ
- ูููู (ุณุนุฑ ุงููููุฉ)
- ุดูุฑู (ุณุนุฑ ุงูุดูุฑ)
- ููุณูู (ุณุจุชูุจุฑ โ ููููู)
- ุณููู

### ุงูุชุฃููู
- ูุทุจู ููุท ุนูู (ุดูุฑู โ ููุณูู โ ุณููู)
- ูููุฉ ุงูุชุฃููู = ุณุนุฑ ุฃูู ุดูุฑ
- ูุธูุฑ ูุจูุฏ ูุณุชูู ูู ุงููุงุชูุฑุฉ
- ูุง ููุฌุฏ ุชุฃููู ูู ุงูุฅูุฌุงุฑ ุงููููู

---

## 06-booking-flow.md | ูุณุงุฑ ุงูุญุฌุฒ (Booking Flow)

### ุงููุฏู
ุชุญุฏูุฏ ูุณุงุฑ ุงูุญุฌุฒ ุจุฏูุฉ ูุชุญูููู ุฅูู **State Machine** ูุงุถุญุฉ ุชููุน ุฃู ุชุนุงุฑุถ ูู ุงูุญุงูุงุช ุฃู ุงูุตูุงุญูุงุช.

---

### ุงูุญุงูุงุช ุงูุฃุณุงุณูุฉ ููุญุฌุฒ (Booking States)

```txt
idle โ request_sent โ pending_landlord
        โ (ุฑูุถ)
      rejected
        โ (ูุจูู)
      approved โ booked โ occupied โ completed
```

---

### ุดุฑุญ ุงูุญุงูุงุช

#### 1. idle
- ุงูุญุงูุฉ ุงูุงูุชุฑุงุถูุฉ
- ุงูุนูุงุฑ ูุชุงุญ ููู ูุชู ุฅุฑุณุงู ุฃู ุทูุจ

#### 2. request_sent
- ุงููุณุชุฃุฌุฑ:
  - ุณุฌู / ุฃูุดุฃ ุญุณุงุจ
  - ุฏูุน 50 ุฌููู ุฌุฏูุฉ ุญุฌุฒ
- ุชู ุฅุฑุณุงู ุงูุทูุจ ูููุคุฌุฑ

#### 3. pending_landlord
- ุงูุทูุจ ูู ุงูุชุธุงุฑ ูุฑุงุฑ ุงููุคุฌุฑ
- ูุง ูููู ูููุณุชุฃุฌุฑ ุชุนุฏูู ุงูุทูุจ

#### 4. rejected
- ุงููุคุฌุฑ ุฑูุถ ุงูุทูุจ
- ูุชู:
  - ุฅุนุงุฏุฉ ูุชุญ ุงูุนูุงุฑ
  - ุฅุธูุงุฑ ุฅุดุนุงุฑ ูููุณุชุฃุฌุฑ

#### 5. approved
- ุงููุคุฌุฑ ูุงูู ุนูู ุงูุทูุจ
- ูุชู:
  - ุงูุงุชูุงู ุนูู ุงูุชุฃููู
  - ุชุซุจูุช ูุฏุฉ ุงูุฅูุฌุงุฑ

#### 6. booked
- ุชู ุชุฃููุฏ ุงูุญุฌุฒ
- ุงูุนูุงุฑ ุบูุฑ ุธุงูุฑ ููุญุฌุฒ ูู ูุณุชุฎุฏููู ุขุฎุฑูู

#### 7. occupied
- ุงููุณุชุฃุฌุฑ ุงุณุชูู ุงูุนูุงุฑ
- ุจุฏุงูุฉ ูุฏุฉ ุงูุฅูุฌุงุฑ ุงููุนููุฉ

#### 8. completed
- ุงูุชูุช ูุฏุฉ ุงูุฅูุฌุงุฑ
- ุงูุนูุงุฑ ูุนูุฏ ุฅูู ุญุงูุฉ ูุชุงุญ

---

### ููุงุนุฏ ุงูุชุญูู (Guards & Rules)

- ุชุบููุฑ ุงูุญุงูุฉ ูู:
  - request_sent โ pending_landlord โ approved / rejected
    ูุชู ููุท ุจูุงุณุทุฉ **ุงููุคุฌุฑ**

- ุงูุงูุชูุงู ุฅูู occupied:
  - ูุชู ููุท ูู ุชุงุฑูุฎ ุงูุงุณุชูุงู

- ูุง ูุณูุญ ุจุงูุญุฌุฒ ุงููุชุฏุงุฎู (Overlapping)

---

### ุฃููุงู ุงูุญุงูุงุช ูู UI

| ุงูุญุงูุฉ | ุงูููู |
|------|------|
| idle / available | ุฃุฎุถุฑ |
| pending_landlord | ุฃุตูุฑ |
| approved | ุฃุฒุฑู |
| booked | ุจุฑุชูุงูู |
| occupied | ุฃุญูุฑ |
| completed | ุฑูุงุฏู |

---

### ุฃุญุฏุงุซ ุงููุธุงู (Events)

| ุงูุญุฏุซ | ุงููุงุนู |
|------|-------|
| send_booking_request | ุงููุณุชุฃุฌุฑ |
| accept_booking | ุงููุคุฌุฑ |
| reject_booking | ุงููุคุฌุฑ |
| confirm_checkin | ุงููุคุฌุฑ |
| auto_complete | ุงููุธุงู |

---



## 07-property-status.md | ุญุงูุงุช ุงูุนูุงุฑ
- available (ูุชุงุญ)
- pending (ููุฏ ุงููุฑุงุฌุนุฉ)
- approved (ููุจูู)
- booked (ูุญุฌูุฒ)
- occupied (ูุณุชุฃุฌุฑ)
- expired (ููุชูู)

ูุน ุชุบููุฑ ููู ุงูุนุฑุถ ุญุณุจ ุงูุญุงูุฉ.

---

## 08-search-and-ui.md | ุงูุจุญุซ ููุงุฌูุฉ ุงููุณุชุฎุฏู

### ุงูุจุญุซ
ุชุตููุฉ ุญุณุจ:
- ููุน ุงูุนูุงุฑ
- ุงูุณุนุฑ
- ุงููููุฒุงุช
- ุงููููุน (ูุฑุชุจุท ุจุงูุฎุฑูุทุฉ)

### ุงูุชุฎุตูุต ุงูุฐูู
- ุญุณุงุจ ุทุงูุจ โ ุงูุฃุฑุฎุต + ุงูุฃูุฑุจ ููุฌุงูุนุฉ
- ุณูุงุญุฉ โ ุงูุฃูุฑุจ ููุจุญุฑ ูุงููุงูููุงุช

---

## 09-property-details-page.md | ุตูุญุฉ ุชูุงุตูู ุงูุนูุงุฑ
- ุตูุฑ (ุงุฎุชูุงุฑู):
  - ุงูุดุงุฑุน / ุงูุนูุงุฑุฉ
  - ุงูุตุงูุฉ
  - ุบุฑู ุงูููู
  - ุงูุจููููุฉ
- ุตูุฑุฉ ูุงุญุฏุฉ ุนูู ุงูุฃูู
- ุญุงุณุจุฉ ุณุนุฑ ุงูููุงูู ููุฅูุฌุงุฑ ุงููููู

---

## 10-communication.md | ุงูุชูุงุตู
- ุฑุณุงุฆู ุจูู ุงููุณุชุฃุฌุฑ ูุงููุคุฌุฑ ุจุนุฏ ุงููุจูู
- ุชูุณูู:
  - ููุนุฏ ุงูุงุณุชูุงู
  - ุทุฑููุฉ ุงูุฏูุน

---

## 11-database-schema.md | ูุฎุทุท ูุงุนุฏุฉ ุงูุจูุงูุงุช (Supabase)

### ุงููุฏู
ุชุญููู **State Machine** ุฅูู ุฌุฏุงูู ูููุงุนุฏ (Constraints) ุชููุน ุฃู ุงูุชูุงู ุญุงูุฉ ุบูุฑ ูุณููุญ.

---

## ุฌุฏูู bookings
ููุซู ุงูุญุฌุฒ ููุณู (ุงูุนูุงูุฉ ุจูู ูุณุชุฃุฌุฑ + ุนูุงุฑ + ูุฏุฉ).

```sql
CREATE TABLE bookings (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),

  property_id UUID NOT NULL REFERENCES properties(id),
  tenant_id UUID NOT NULL REFERENCES profiles(id),
  landlord_id UUID NOT NULL REFERENCES profiles(id),

  rental_type TEXT CHECK (rental_type IN ('daily','monthly','seasonal','yearly')),

  start_date DATE NOT NULL,
  end_date DATE NOT NULL,

  base_price NUMERIC NOT NULL,
  service_fee NUMERIC NOT NULL,
  deposit_amount NUMERIC DEFAULT 0,
  total_amount NUMERIC NOT NULL,

  status TEXT CHECK (
    status IN (
      'request_sent',
      'pending_landlord',
      'rejected',
      'approved',
      'booked',
      'occupied',
      'completed'
    )
  ) DEFAULT 'request_sent',

  created_at TIMESTAMP DEFAULT now(),
  updated_at TIMESTAMP DEFAULT now()
);
```

---

## ุฌุฏูู property_status_history
ูุณุฌู **ูู ุชุบููุฑ ุญุงูุฉ** ููุนูุงุฑ (Audit Log).

```sql
CREATE TABLE property_status_history (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  property_id UUID REFERENCES properties(id),
  booking_id UUID REFERENCES bookings(id),

  old_status TEXT,
  new_status TEXT,

  changed_by UUID REFERENCES profiles(id),
  changed_at TIMESTAMP DEFAULT now()
);
```

---

## ุฌุฏูู properties (ุฅุถุงูุฉ ุญูู ุงูุญุงูุฉ)

```sql
ALTER TABLE properties
ADD COLUMN status TEXT CHECK (
  status IN ('available','pending','approved','booked','occupied','expired')
) DEFAULT 'available';
```

---

## Rules & Constraints (ููุงุนุฏ ุตุงุฑูุฉ)

### 1. ููุน ุงูุญุฌุฒ ุงููุชุฏุงุฎู
```sql
-- ูุง ูุณูุญ ุจุฃู ุญุฌุฒ ุฌุฏูุฏ ุฅุฐุง ูุงู ุงูุนูุงุฑ ูุญุฌูุฒ ุฃู ูุณุชุฃุฌุฑ
CHECK (status NOT IN ('booked','occupied'))
```

### 2. ูู ูุบูุฑ ุงูุญุงูุฉุ
- ุงูุงูุชูุงูุงุช ุงูุชุงููุฉ **ูุณููุญ ุจูุง ููุท ูููุคุฌุฑ**:
  - request_sent โ pending_landlord
  - pending_landlord โ approved / rejected
  - approved โ booked
  - booked โ occupied

### 3. ุฅุบูุงู ุชููุงุฆู ููุญุฌุฒ
- ุนูุฏ end_date:
  - booking โ completed
  - property โ available

(ุชููุฐ ุจูุงุณุทุฉ Cron Job ุฃู Edge Function)

---

## Policy (Supabase RLS)

### ุงููุคุฌุฑ
- ูุฑู ุญุฌูุฒุงุช ุนูุงุฑุงุชู ููุท
- ูููู ุชุญุฏูุซ status ููุท

### ุงููุณุชุฃุฌุฑ
- ูุฑู ุญุฌูุฒุงุชู ููุท
- ูุง ููููู ุชุนุฏูู status

---

## ููุงุญุธุงุช ุชูููุฐูุฉ (PM Notes)
- ูุฐุง ุงููุฎุทุท ูู ุงููุฑุฌุน ุงููุญูุฏ ููู Backend
- ุฃู ุชุนุฏูู ูู ุงูุญุงูุงุช ูุจุฏุฃ ูู State Machine ุซู ููุง
- ูุง ูุชู ุงูุณูุงุญ ุจุฃู ุชุญุฏูุซ ูุจุงุดุฑ ููุญุงูุฉ ุจุฏูู ุชุณุฌูู History

---

โ **ุชู ุชุญููู State Machine ุฅูู Database Schema ูุญูู**