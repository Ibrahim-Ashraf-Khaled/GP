# ๐ ุชูุฑูุฑ ุชุญููู ุงูุจููุฉ ุงูุชุญุชูุฉ ูุงููุนูุงุฑูุฉ - ูุดุฑูุน ุนูุงุฑุงุช ุฌูุตุฉ
ุชุงุฑูุฎ ุงูุชูุฑูุฑ: 20 ูุจุฑุงูุฑ 2026

---

## 1. ุชูุญูุฏ ุฃูุธูุฉ ุงููุตุงุฏูุฉ (Auth Consolidation)

### ๐ ุชุญููู ุงููุถุน ุงูุญุงูู
ููุชูู ุงููุดุฑูุน ุญุงููุงู ูุธุงููู ูุณุชูููู ูููุตุงุฏูุฉ ูุนุชูุฏุงู ุนูู ูุตุงุฏุฑ ุจูุงูุงุช ูุฎุชููุฉ ููุบุงุช ุจุฑูุฌุฉ ูุชุจุงููุฉุ ููุง ูุณุจุจ ุชุถุงุฑุจุงู ูู ุญุงูุฉ ุงููุณุชุฎุฏู ุนุจุฑ ุงูุชุทุจูู.

| ุงูุฌุงูุจ | `AuthContext` (Context API) | `useUser` (Custom Hook) |
|--------|--------------------------|-----------------------|
| **ุงูููู** | `src/context/AuthContext.tsx` | `src/hooks/useUser.ts` |
| **ูุตุฏุฑ ุงูุญูููุฉ** | localStorage + ุงุณุชุฏุนุงุกุงุช Supabase | Supabase Auth + Profiles Table |
| **ุฏุนู ุงููุธุงุฆู** | ูุฏุนู ุชุณุฌูู ุงูุฏุฎูู ูุงูุฎุฑูุฌ ูุฏููุงู | ูุฏุนู ูุฑุงูุจุฉ ุงูุญุงูุฉ (onAuthStateChange) |
| **ุงูููุซูููุฉ** | ูุชูุณุทุฉ (ูุนุชูุฏ ุนูู ุชุฎุฒูู ูุญูู ูุฏ ูุง ูุชุทุงุจู ูุน ุงูุฌูุณุฉ) | ุนุงููุฉ (ูุฑุชุจุท ูุจุงุดุฑุฉ ุจุฌูุณุฉ Supabase) |

### โ๏ธ ุงููุดููุงุช ุงูููุชุดูุฉ
1. **ุฏูุงู ููููุฏุฉ:** ูุงุฌูุฉ `useAuth` ุชูุณุชุฎุฏู ูู ููููุงุช (ูุซู `LoginForm`, `SignUpForm`) ูุงุณุชุฏุนุงุก ุฏูุงู ูุซู `signInWithGoogle` ู `signUp` ููู ุบูุฑ ููุฌูุฏุฉ ูุนููุงู ูู ููู ุงูู Context.
2. **ุชูุฑุงุฑ ููุทู ุงูุจูุงูุงุช:** ูุชู ุฌูุจ ุจูุงูุงุช ุงูููู ุงูุดุฎุตู ูุฑุชูู ุจุทุฑููุชูู ูุฎุชููุชููุ ูุฑุฉ ุนุจุฑ `storage.ts` ููุฑุฉ ุนุจุฑ `fetchProfile` ูู ุงูู Hook.
3. **ูุฎุงุทุฑ ุงูู Mock Mode:** ูุนุชูุฏ `AuthContext` ุจุดุฏุฉ ุนูู localStorage ููุญุงูุงุฉ ุงูุฏุฎููุ ุจูููุง ูุชููุน ุจุงูู ุงูุชุทุจูู ุจูุงูุงุช ุญููููุฉ ูู Supabase.

### ๐ก ุงูุญู ุงูููุชุฑุญ
- **ุฏูุฌ ุงููุธุงููู:** ุฌุนู `AuthContext` ูู ุงูููุฒุน ุงููุญูุฏ ููุจูุงูุงุชุ ูุน ุชุญููู `useUser` ููููู ุงููุธููุฉ ุงูุฏุงุฎููุฉ ุงูุชู ุชุบุฐู ูุฐุง ุงูู Context.
- **ุชุญุฏูุซ ุงููุงุฌูุงุช:** ุฅุถุงูุฉ ูุงูุฉ ุฏูุงู ุงููุตุงุฏูุฉ (Google, Facebook, Email SignUp) ุฅูู `AuthContext` ูุชูุงุฏู ุฃุฎุทุงุก ุงูู Runtime.
- **ุฅุฒุงูุฉ ุงูุงุนุชูุงุฏ ุนูู localStorage:** ุงูุงูุชูุงู ูููุงู ูู Supabase Session ููุตุฏุฑ ูุญูุฏ ููุญูููุฉ.

---

## 2. ุจููุฉ ุงูู API (API Architecture)

### ๐ ุชุญููู ุงููุถุน ุงูุญุงูู
ูุง ุชูุฌุฏ ุทุจูุฉ API ูุณูุทุฉ (Backend-for-Frontend) ูู ุงููุดุฑูุน. ุงูููููุงุช ุชุชุตู ูุจุงุดุฑุฉ ุจู Supabase ุฃู ุชุณุชุฎุฏู ููู `supabaseService.ts` ุงูุถุฎู.

### โ๏ธ ุงููุดููุงุช ุงูููุชุดูุฉ
1. **ุชุถุฎู ููู ุงูุฎุฏูุงุช:** ููู `src/services/supabaseService.ts` ูุชุฌุงูุฒ 1500 ุณุทุฑุ ููุง ูุฌุนูู "God Object" ูุตุนุจ ุตูุงูุชู ุฃู ุงุฎุชุจุงุฑู.
2. **ุบูุงุจ ูุณุงุฑุงุช API:** ูุง ุชูุฌุฏ ูุณุงุฑุงุช ูู `src/app/api/` ูุงุณุชุถุงูุฉ ููุทู ุงูุนูู ุงูุญุณุงุณ ุงูุฐู ูุง ูุฌุจ ุฃู ูุฑุงู ุงูุนููู (ูุซู ุงูุชุญูู ูู ุงููุฏููุนุงุช ุฃู ุฅุฑุณุงู ุงูุฅุดุนุงุฑุงุช).
3. **ุถุนู ุงูุฃูุงู:** ุงุณุชุฏุนุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุจุงุดุฑุฉ ูู ุงููุชุตูุญ ูุฏ ูุนุฑุถ ููุทู ุงูุนูู (Business Logic) ููุชูุงุนุจ ุฅุฐุง ูู ุชูู ููุงุนุฏ RLS ูุญููุฉ ุจูุณุจุฉ 100%.

### ๐ก ุงูุญู ุงูููุชุฑุญ
- **ุฅูุดุงุก ูุฌูุฏ ุงูู API:** ุชูุนูู ูุณุงุฑุงุช `src/app/api/` ููุนูููุงุช ุงูุชู ุชุชุทูุจ ุญูุงูุฉ ุฅุถุงููุฉ ุฃู ุทุฑูุงู ุซุงูุซุงู.
- **ุชูุณูู ุงูุฎุฏูุงุช:** ุชูุชูุช ููู `supabaseService.ts` ุฅูู ุฎุฏูุงุช ูุชุฎุตุตุฉ (PropertiesService, BookingService, PaymentService).
- **ุทุจูุฉ ุงูุชุญูู (Validation):** ุงุณุชุฎุฏุงู ููุชุจุงุช ูุซู Zod ุฏุงุฎู ูุณุงุฑุงุช API ูุถูุงู ุณูุงูุฉ ุงูุจูุงูุงุช ูุจู ูุตูููุง ููุงุนุฏุฉ ุงูุจูุงูุงุช.

---

## 3. ุชุถุงุฑุจ ุงูุชุณููุงุช ูุชูุงูู ุงูุจูุงูุงุช (Data Consistency)

### ๐ ุชุญููู ุงููุถุน ุงูุญุงูู
ููุฌุฏ ุชุถุงุฑุจ ุญุงุฏ ุจูู ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ (ุงููุณุชุฎุฏูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช) ูุงููุบุฉ ุงูุนุฑุจูุฉ (ุงููุณุชุฎุฏูุฉ ูู ุจุนุถ ุฃููุงุน ุงูุจูุงูุงุช ูุงููุงุฌูุงุช).

### โ๏ธ ุงููุดููุงุช ุงูููุชุดูุฉ
1. **ุชุถุงุฑุจ ุงูุฃุฏูุงุฑ (Roles):** 
   - ูุงุนุฏุฉ ุงูุจูุงูุงุช ุชุชููุน: `landlord`, `tenant`.
   - ุจุนุถ ุงูู Hooks ุชุณุชุฎุฏู: `ูุคุฌุฑ`, `ูุณุชุฃุฌุฑ`.
   - **ุงููุชูุฌุฉ:** ุณุชูุดู ุนูููุงุช ุงูุฅุฏุฎุงู ุฃู ุงูููุงุฑูุฉ ูุฃู 'ูุคุฌุฑ' != 'landlord'.
2. **ุชุดุชุช ุงูุชุนุฑููุงุช (Type Interface Bloat):**
   - ููุฌุฏ ุชุนุฑูู ูู `Property` ูู `types/index.ts` ูุชุนุฑูู ุขุฎุฑ ูู `database.types.ts`.
   - **ุงููุชูุฌุฉ:** ุบููุถ ูู ุงูุญููู ุงููุชุงุญุฉ ูุชูุฑุงุฑ ูู ุงูููุฏ ุงููุณุชูุฑุฏ.
3. **ุงูุชูุงุตู ุจูู ุงูุฌุจูุฉ ูุงูุฎูููุฉ:** ุงุณุชุฎุฏุงู ูุฎุฑุฌุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุฎุงู ูุจุงุดุฑุฉ ูู ุงููุงุฌูุฉ (ูุซู enum ุงูููู) ูููู ูู ุฌูุฏุฉ ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู ุฅุฐุง ูู ุชูุชุฑุฌู ุจุดูู ููุญุฏ.

### ๐ก ุงูุญู ุงูููุชุฑุญ
- **ุงูุฅูุฌููุฒูุฉ ููุฎูููุฉุ ุงูุนุฑุจูุฉ ูููุงุฌูุฉ:** ุชุซุจูุช ูุงูุฉ ุงูููู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุงูู Logic ุจุงููุบุฉ ุงูุฅูุฌููุฒูุฉุ ูุงุณุชุฎุฏุงู ุฎุฑุงุฆุท ุชุฑุฌูุฉ (ูุซู `ROLE_LABELS` ู `STATUS_AR`) ููุนุฑุถ ููุท.
- **ุชูุญูุฏ ูุตุฏุฑ ุงูุฃููุงุน:** ุฌุนู `database.types.ts` ูู ุงููุตุฏุฑ ุงููุญูุฏ (Single Source of Truth) ูุฌููุน ุงูู Interfacesุ ูุน ุนูู `Extension` ููุง ูู ุงููููุงุช ุงูุฃุฎุฑู ุนูุฏ ุงูุญุงุฌุฉ ูุฅุถุงูุฉ ุญููู ูุคูุชุฉ.
- **ุฃุชูุชุฉ ุงููุญุต:** ุฅุถุงูุฉ ููุงุนุฏ ESLint ุฃู ูุตูุต ูุญุต TypeScript ุชููุน ุงุณุชุฎุฏุงู ุงูููู ุงูุนุฑุจูุฉ ูู ุงูุญูู `role`.

---

## ๐ ุฎุทุฉ ุงูุนูู ุงูููุตู ุจูุง (Priorities)

1. **ุฃููููุฉ ูุตูู (ุญูุฑุงุก):** ุชุตุญูุญ ุงูููู ุงูุนุฑุจูุฉ ูู ุญูู ุงูู `role` ูุชุญููููุง ููุฅูุฌููุฒูุฉ ูุชูุงุฏู ูุดู ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช.
2. **ุฃููููุฉ ุนุงููุฉ (ุจุฑุชูุงููุฉ):** ุฅุถุงูุฉ ุงูุฏูุงู ุงููุงูุตุฉ ูู `AuthContext` ูุฅุตูุงุญ ุฃุฎุทุงุก ุงูุตูุญุงุช ุงูุญุงููุฉ.
3. **ุฃููููุฉ ูุชูุณุทุฉ (ุตูุฑุงุก):** ุงูุจุฏุก ูู ููู ุงูููุทู ูู `supabaseService.ts` ุฅูู ูุณุงุฑุงุช API ููุธูุฉ.
